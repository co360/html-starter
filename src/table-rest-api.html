<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>OJET Starter</title>
  <link rel="icon" href="css/images/favicon.ico" type="image/x-icon" />
  <link rel="stylesheet" href="css/alta/6.2.0/web/alta.css"/>

  <script type="text/javascript" src="js/libs/require/require.js"></script>
  <script type="text/javascript" src="js/main.js"></script>
  <script>
    require(['knockout', 'jquery', 'ojs/ojcore', 'ojs/ojknockout',
      'ojs/ojtable', 'ojs/ojarraytabledatasource'],
            function(ko, $){
      function AppViewModel() {
        let self = this;

        // First initialize an array
        var dataArray;
        var endpoint = "https://api.github.com/repositories";
        $.ajax({
          async: false,
          url : endpoint,
          method: "GET",
          dataType: 'json',
          success: function(kmResponse) {
            // console.log(`Fetch ${endpoint} result:`);
            // console.log(kmResponse);
            dataArray = kmResponse;
          }
        });

        // Then create an ArrayTableDataSource object with the array
        self.datasource = new oj.ArrayTableDataSource(dataArray, {idAttribute: 'id'});
      }
      ko.applyBindings(new AppViewModel());
    });
  </script>
</head>
<body>

<oj-table data='{{datasource}}'
        columns='[
            {"headerText": "id", "field": "id"},
            {"headerText": "name", "field": "name"},
            {"headerText": "description", "field": "description"},
            {"headerText": "html_url", "field": "html_url"}
            ]'>
</oj-table>

</body>
</html>
