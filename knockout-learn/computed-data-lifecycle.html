<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>HTML/CSS/JavaScript Starter</title>
    <script src="../resources/js/libs/knockout/knockout-3.5.0.debug.js"></script>
</head>
<body>

<div id="demo">
    <p data-bind="ifnot: firstName">
        Waiting <code>viewModel.firstName</code> to be set.
        Use console to change the value.
        Example: <code>viewModel.firstName("Hello").lastName("World");</code>
    </p>

    <div data-bind="if: firstName">
        <p>The name is <span data-bind="text: fullName"></span></p>
    </div>
</div>

<script>
    /**
     * BUG? The KO docs (3.5.0) says "if" will not render the DOM elements if the condition
     * is false, but yet the "fullName" computed attribute is invoked despite this?
     *
     * Notice this example has "if" binding guarded the usage of "fullName"
     * which is a computed method. But even if "if" condition is false, the
     * computed function WILL BE INVOKED! This mean you must check
     * the observable being computed on before usage!
     *
     * Another option is guard the UI with "if" on the "fullName" computed
     * attribute instead. This makes the problem occur more earlier and obvious
     * if not handled properly.
     */
    function AppViewModel() {
        let self = this;
        self.firstName = ko.observable();
        self.lastName = ko.observable();

        self.fullName = ko.computed(function() {
            console.log("Computed fullName is invoked.");
            if (!self.firstName())
                return;
            return self.firstName() + " " + self.lastName();
        });
    }
    let viewModel = new AppViewModel();
    ko.applyBindings(viewModel, document.getElementById("demo"));
</script>

</body>
</html>

